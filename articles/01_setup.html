<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setup and data provenance • FluxDataKit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- Fonts --><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,300;0,400;0,700;1,300;1,400&amp;display=swap" rel="stylesheet">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- geco --><link href="../geco.css" rel="stylesheet">
<meta property="og:title" content="Setup and data provenance">
<meta property="og:description" content="FluxDataKit">
<meta name="twitter:card" content="summary">
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">

      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="external-link hidden-sm hidden-xs" href="https://geco-group.org/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_white_small.png" id="hexlogo" alt="GECO"></a>
        <a class="external-link hidden-md hidden-lg" href="https://geco-group.org/">
          <img src="https://raw.githubusercontent.com/computationales/GECO_template/main/geco_logo_white_small.png" id="hexlogo" alt="GECO"></a>
        <a class="navbar-brand" href="../index.html">
           <i>FluxDataKit <small>v0.9</small></i>
        </a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_setup.html">Setup and data provenance</a>
    </li>
    <li>
      <a href="../articles/02_data_coverage.html">Data coverage</a>
    </li>
    <li>
      <a href="../articles/03_data_generation.html">Data generation</a>
    </li>
  </ul>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Setup and data provenance</h1>
                        <h4 data-toc-skip class="author">Koen
Hufkens</h4>
            
      
      
      <div class="hidden name"><code>01_setup.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Install all critical packages required in gathering and processing
the data by installing the <code>FluxDataKit</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span></span>
<span>  <span class="st">"computationales/FluxDataKit"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In addition clone the project as we’ll need some additional scripts
which are only available in the source code of the project (see data
provenance below).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">git</span> clone https://github.com/computationales/FluxDataKit.git</span></code></pre></div>
<p>With all tools installed we need to download the required input data
for aggregation.</p>
</div>
<div class="section level2">
<h2 id="data-provenance-downloads">data provenance (downloads)<a class="anchor" aria-label="anchor" href="#data-provenance-downloads"></a>
</h2>
<p>A list of numbered scripts is provided in the <code>data-raw</code>
directory of the cloned project, and which govern the downloading and
compiling of intermediate data. The numbered scripts should be run in
sequence. All code is written in <code>R</code> and should be executed
in the project environment of the <code>FluxDataKit</code> package
(i.e. open the FluxDataKit.proj file in RStudio or make sure you have
set the topmost directory to the project folder).</p>
<p>Due to login-walls, or missing API infrastructure, most data
downloads are still manual instead of automated. The below section
therefore links to the locations where you can manually get the data. No
fixes will be provided to facilitate this process further.</p>
<p>By default the data will be downloaded to a directory with the
<code>data-raw/</code> base path. Before running any scripts, check if
data is written to this directory. When you want to alter the storage
location you may use soft links.</p>
<div class="section level3">
<h3 id="meta-data">Meta data<a class="anchor" aria-label="anchor" href="#meta-data"></a>
</h3>
<p>Meta-data is compiled on a site by site basis using the
<code>01_collect_meta-data.R</code> script. This will compile all easily
available meta-data through either API calls or scraping the data
downloaded in the previous step (setup / data collection). In the
current scirpt paths are set for data stored in <code>data-raw</code>.
However, you are free to move the data anywhere you like as long as you
adjust the paths in the meta-data script.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"data-raw/01_collect_meta-data.R"</span><span class="op">)</span></span></code></pre></div>
<p>Given the various datasets, and at times overlap between the datasets
a priority in processing is given to more recent (hopefully) and more
complete datasets. In order of processing this means that OneFlux has
priority over FLUXNET2015, and Plumber2. ICOS data has priority over
FLUXNET2015 for European sites. Overall, Plumber2 mostly fills in the
remaining sites in Asia and Australia. The final picking order is
specified and processed by calling the below script.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"data-raw/02_compile_final_site_list.R"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flux-data">Flux data<a class="anchor" aria-label="anchor" href="#flux-data"></a>
</h3>
<p>All ecosystem flux sources should be downloaded at half-hourly (HH)
rates. Data sources and final paths are listed below. Top level paths
for flux data are considered to be sufficient for further
processing.</p>
<p>Estimated data sizes are provided to indicate network load, although
for most these downloads should be easily manageable from a download and
storage perspective. Below you find a summary table of data volumes, nr.
of sites and the local storage paths for all flux data products
considered.</p>
<table class="table">
<thead><tr class="header">
<th>product</th>
<th align="center">data volume</th>
<th align="center">nr. sites</th>
<th align="left">data path</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>FLUXNET2015</td>
<td align="center">~35GB</td>
<td align="center">166</td>
<td align="left"><code>data-raw/flux_data/fluxnet2015/</code></td>
</tr>
<tr class="even">
<td>ICOS</td>
<td align="center">~12GB</td>
<td align="center">67</td>
<td align="left"><code>data-raw/flux_data/icos/</code></td>
</tr>
<tr class="odd">
<td>Ameriflux OneFlux</td>
<td align="center">~12GB</td>
<td align="center">74</td>
<td align="left"><code>data-raw/flux_data/oneflux/</code></td>
</tr>
<tr class="even">
<td>Plumber2</td>
<td align="center">~4GB</td>
<td align="center">112</td>
<td align="left"><code>data-raw/flux_data/plumber_fluxnet/</code></td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="fluxnet2015">FLUXNET2015<a class="anchor" aria-label="anchor" href="#fluxnet2015"></a>
</h4>
<p>FLUXNET2015 data is downloaded from the dedicated <a href="https://fluxnet.org/data/fluxnet2015-dataset/" class="external-link">download page</a>.
A login is required to access the data. We only considered the legacy
<strong>FULLSET</strong> data, which is covered by a CC-BY 4.0 license.
This limits the site count. Expanding this list is possible, but only
with permission from the PI sharing the data. We refer to the <a href="https://fluxnet.org/data/data-policy/" class="external-link">data policy</a> for more
details.</p>
</div>
<div class="section level4">
<h4 id="icos">ICOS<a class="anchor" aria-label="anchor" href="#icos"></a>
</h4>
<p>As of writing ICOS data was provided as a pre-release to our group
and is therefore not yet available for a wider public. However, this
data should be released shortly through the <a href="https://www.icos-cp.eu/data-services/about-data-portal" class="external-link">ICOS
carbon portal</a>.</p>
</div>
<div class="section level4">
<h4 id="ameriflux-oneflux">Ameriflux OneFlux<a class="anchor" aria-label="anchor" href="#ameriflux-oneflux"></a>
</h4>
<p>A limited set of sites has been reprocessed using the Ameriflux
OneFlux processing chain. The data should be downloaded manually from
the <a href="https://ameriflux.lbl.gov/login/?redirect_to=/data/download-data/" class="external-link">website
data portal</a>. A login is required.</p>
</div>
<div class="section level4">
<h4 id="plumber2">Plumber2<a class="anchor" aria-label="anchor" href="#plumber2"></a>
</h4>
<p>“PLUMBER2 is a model inter-comparison project for land surface
models. Multiple leading land surface and ecosystem models are evaluated
for water and carbon fluxes at 170 flux tower sites, spanning multiple
biomes and climate zones globally.” the full description of the dataset
can be found in the publication by <a href="https://doi.org/10.5194/essd-2021-181" class="external-link">Ukkola et al. 2021</a> and
combines FLUXNET2015, La Thuile and OzFlux collections.</p>
<p>The downloading and conversion is facilitated using a script
<code>00_download_convert_flux_data.R</code> included in the
<code>data-raw</code> directory.</p>
</div>
</div>
<div class="section level3">
<h3 id="gridded-products">Gridded products<a class="anchor" aria-label="anchor" href="#gridded-products"></a>
</h3>
<p>Other gridded data products are required to complement the flux data
for modelling purposes. Products required, data volumes and storage
paths are listed below. Detailed links to original publications and data
are provided below.</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="50%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>product</th>
<th align="center">data volume</th>
<th align="left">data path</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>rooting zone water storage</td>
<td align="center">~80MB</td>
<td align="left"><code>data-raw/ancillary_data/rooting_zone_water_storage/</code></td>
</tr>
<tr class="even">
<td>Koeppen-Geiger</td>
<td align="center">~22MB</td>
<td align="left"><code>data-raw/ancillary_data/koeppen_geiger/</code></td>
</tr>
<tr class="odd">
<td>field capacity</td>
<td align="center">~4MB</td>
<td align="left"><code>data-raw/ancillary_data/field_capacity/</code></td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="rooting-zone-water-storage-capacity">Rooting zone water storage capacity<a class="anchor" aria-label="anchor" href="#rooting-zone-water-storage-capacity"></a>
</h4>
<p>Global rooting zone water storage capacity can be <a href="https://zenodo.org/record/5515246" class="external-link">downloaded here</a> (Stocket et
al. 2020).</p>
</div>
<div class="section level4">
<h4 id="koeppen-geiger-included-in-repo">Koeppen-Geiger (included in repo)<a class="anchor" aria-label="anchor" href="#koeppen-geiger-included-in-repo"></a>
</h4>
<p>Koeppen-Geiger climate classifications are downloaded from the recent
work by <a href="https://www.nature.com/articles/sdata2018214" class="external-link">Beck et
al. 2018</a>. Data can be downloaded from the <a href="http://www.gloh2o.org/koppen/" class="external-link">project website</a> but is also
included in the repository due to its small size.</p>
</div>
<div class="section level4">
<h4 id="field-capacity-included-in-repo">Field capacity (included in repo)<a class="anchor" aria-label="anchor" href="#field-capacity-included-in-repo"></a>
</h4>
<p>Global Gridded Surfaces of Selected Soil Characteristics on the <a href="https://daac.ornl.gov/SOILS/guides/IGBP-SurfaceProducts.html" class="external-link">ORNL
DAAC</a> provides field capacity values. Data needs to be manually
downloaded from the <a href="https://webmap.ornl.gov/ogc/dataset.jsp?ds_id=569" class="external-link">visualization
tools</a> for easy export into a geotiff format. A ORNL login is
required!</p>
</div>
</div>
<div class="section level3">
<h3 id="remote-sensing-data">Remote sensing data<a class="anchor" aria-label="anchor" href="#remote-sensing-data"></a>
</h3>
<div class="section level4">
<h4 id="modistools">MODISTools<a class="anchor" aria-label="anchor" href="#modistools"></a>
</h4>
<p>MODIS data can be gathered for offline processing (recommended) using
the <code><a href="../reference/fdk_download_modis.html">fdk_download_modis()</a></code> function. This function takes a
list of sites and meta-data to download the required data using the
<code>MODISTools</code> package.</p>
<p>With the site list generated or manually populated you can download
the data stored in the <code>data-raw/modis/</code> directory as:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"data/flux_data_kit_site-info.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/fdk_download_modis.html">fdk_download_modis</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">sites</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"data-raw/modis/"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Consider that this will take a while and is preferably wrapped in a
script to be executed in the background. For one off sites the above
method is valid. For batch processing we refer tot the
<code>04_download_modis_data.R</code> script in the
<code>data-raw</code> directory.</p>
</div>
<div class="section level4">
<h4 id="fluxneteo">FluxnetEO<a class="anchor" aria-label="anchor" href="#fluxneteo"></a>
</h4>
<p>To supplement the land surface model driver data, and the derived
p-model (rsofun) input, we used the <code>FluxnetEO</code> product
(Walther et al. 2022) and similarly named <a href="https://computationales.github.io/FluxnetEO/" class="external-link">package</a>.</p>
<p>Data is provided as <a href="https://meta.icos-cp.eu/collections/tEAkpU6UduMMONrFyym5-tUW" class="external-link">zipped
archives</a> and total considerable amounts of data, which requires
ample storage space. The MODIS dataset has a compressed size of ~32 GB,
which results in an uncompressed size of ~68 GB. The LandSat dataset
exceeds 150 GB compressed (this data will currently not be
considered).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Walther, S., Besnard, S., Nelson, J. A., El-Madany, T. S.,
Migliavacca, M., Weber, U., Carvalhais, N., Ermida, S. L., Brümmer, C.,
Schrader, F., Prokushkin, A. S., Panov, A. V., and Jung, M.: Technical
note: A view from space on global flux towers by MODIS and Landsat: the
FluxnetEO data set, Biogeosciences, 19, 2805–2840, <a href="https://doi.org/10.5194/bg-19-2805-2022" class="external-link uri">https://doi.org/10.5194/bg-19-2805-2022</a>, 2022.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/computationales" target="_blank" class="external-link">
                          <div class="icon fab fa-github"></div></a>
                        <a href="https://computationales.ethz.ch/" target="_blank" class="external-link">
                          <div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/SteniBocker/" target="_blank" class="external-link">
                          <div class="icon fab fa-twitter"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Computationales</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Our Team</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://github.com/computationales" class="external-link">Packages</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Publications</a></li>
                            <li><a href="https://computationales.ethz.ch/" class="external-link">Blog</a></li>
                        </ul>
</div>

                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>

  


  

  </body>
</html>
